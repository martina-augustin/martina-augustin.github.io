<!DOCTYPE html>
<html lang="en" class="no-js" >
<head>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JDC5VMFC86"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-JDC5VMFC86');
    </script>

    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Martina A. | R Markdown report</title>

    <script>
        document.documentElement.classList.remove('no-js');
        document.documentElement.classList.add('js');
    </script>

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="css/vendor.css">
    <link rel="stylesheet" href="css/styles.css">

</head>

<body id="top">


    <!-- preloader
    ================================================== -->
    <div id="preloader">
        <div id="loader" class="dots-fade">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>


    <!-- page wrap
    ================================================== -->
    <div id="page" class="s-pagewrap">


        <!-- # site header 
        ================================================== -->
        <header id="masthead" class="s-header">

            <div class="row s-header__navigation">

                <nav class="s-header__nav-wrap">
    
                    <h3 class="s-header__nav-heading">Navigate to</h3>

                </nav> 
                <!-- end s-header__nav-wrap -->
    
            </div> 
            <!-- end s-header__navigation -->

            <div class="s-header__search">

                <div class="s-header__search-inner">
                    <div class="row">
    
                    </div> <!-- end row -->
                </div> <!-- s-header__search-inner -->
    
            </div> <!-- end s-header__search -->

        </header> <!-- end s-header -->


        <!-- # site-content
        ================================================== -->
        <div id="content" class="s-content s-content--blog">

                <div class="row entry-wrap">
                    <div class="column lg-12">

                        <article class="entry format-standard">

                            <header class="entry__header">
    
                                <h1 class="entry__title">
                                    Automating Analytical Reports with R&nbspMarkdown
                                </h1>

                            </header>

                            <div class="content-primary">

                                <div class="entry__content">
                                    <p class="lead">
                                        Before the global Covid-19 pandemic, I joined a local public speaking club to enhance my 
                                        communication and presentation skills. During my time as a member, I also served as a club 
                                        officer, assisting others with their speaking progress. Traditionally, members provided 
                                        written feedback on paper slips after each speech. However, when meetings transitioned 
                                        from physical to virtual due to lockdown, our feedback collection method shifted from 
                                        hand-written paper slips to Google Forms. Consequently, the club committee revised the 
                                        feedback questions.</p> 

                                    <h3>Goal</h3>
                                    
                                    <p>
                                        With the new questions in place, I realized that speakers would benefit more from visual 
                                        progress reports rather than plain spreadsheets. This need for a more efficient and engaging 
                                        presentation of speech feedback inspired me to design an interactive report using the 
                                        capabilities of RMarkdown.
                                    </p>
                                    <img class="img-responsive" alt="" src="./images/R-report/excel-snapshot-2.jpg">
                                    <!-- <div class="row iframe">
                                        <iframe src="R/RMarkdown/csv_table.html" class="row-iframe iframe-doc" scrolling="yes"
                                            onload="resizeIframe(this)"></iframe>
                                    </div> -->

                                    <h3>Process</h3>
                                    
                                    <p>
                                        To automate the creation of these reports, I developed a process that can generate reports for 
                                        one or more speakers simultaneously using a for loop. This involved two main files:
                                        <ol>
                                            <li>
                                                <b>RMarkdown File (.rmd): </b>
                                                This file handles the bulk of the processing through several steps:
                                                <ul>
                                                    <li><b>Filtering: </b>Data for the selected speaker is filtered.</li>
                                                    <li><b>Data Cleaning: </b>Missing values and duplicate records (often due to connection issues 
                                                        when submitting the Google Form) are removed, and the speech date is extracted.</li>
                                                    <li><b>Data Splitting: </b>The data is divided into scaled variables and text fields, 
                                                        as they are processed differently in subsequent stages.</li>
                                                    <li><b>Reshaping: </b>The scaled variables are reshaped, and a stacked barplot is created.</li>
                                                    <li><b>Text Fields: </b>N/A records are removed from the text fields to avoid blank lines in the 
                                                        final table. These fields were optional, so they were sometimes left empty.</li>
                                                    <li><b>Interactive Table: </b>An interactive table is created.</li>
                                                </ul>
                                            </li>
                                            <li>
                                                <b>R Script: </b>
                                                This script loads the spreadsheet, extracts speaker names and speech titles, and then calls the .rmd 
                                                file for the selected speakers.
                                            </li>
                                        </ol>
                                        To enhance the final HTML report, I also created a simple .css stylesheet linked to the .rmd file, allowing 
                                        for custom fonts, colors, spacing, and a unique footer.
                                    </p> 


                                    <h3>Result</h3>

                                    <p>
                                        The automated process produces two possible outputs:
                                        <ol>
                                            <li><b>HTML Report: </b>This interactive report allows speakers to see the number of attendees who rated 
                                                their speech and includes a reactive table that highlights rows as the viewer hovers over them, making 
                                                it easier to read.</li>
                                            <li><b>PDF Report: </b>This is generated by printing the HTML document, providing a static version of the 
                                                interactive report.</li>
                                        </ol>
                                    </p>
                                    <!-- iframe height was sorted with the following js code: https://css-tricks.com/snippets/jquery/fit-iframe-to-content/
                    	                It seems to work well for a regular screen, however not so well for smaller screens. -->
                                    <div class="row iframe">
                                        <iframe src="R/RMarkdown/RMarkdown.html" class="row-iframe iframe-doc" scrolling="yes"
                                            onload="resizeIframe(this)"></iframe>
                                    </div>
                                    <p>
                                        The automated system ensures that all reports for the speakers are produced efficiently without the need to 
                                        create each document separately. The complete code for this process can be found 
                                        <a href="https://github.com/martina-augustin/R-Markdown-report" target="_blank">here</a>.
                                    </p>

                                </div> 
                                <!-- end entry-content -->

                                <div class="post-nav">
                                    <div class="post-nav__prev">
                                        <a href="R-data-viz.html" rel="prev">
                                            <span>Prev</span>
                                            Three Graphs to Analyze Commuting Patterns in the UK
                                        </a>
                                    </div>
                                    <div class="post-nav__next">
                                        <a href="R-markdown-slides.html" rel="next">
                                            <span>Next</span>
                                            Creating Slides Programmatically with R Markdown
                                        </a>
                                    </div>
                                </div>
                                
                                <div class="column lg-12 text-center" style="margin-top: 3rem;">
                                    <p>
                                        <a class="btn" href="index.html">Back to main page</a>
                                    </p>
                                    
                                </div>

                            </div> 
                            <!-- end content-primary -->

                        </article> 
                        <!-- end entry -->

                    </div>
                </div> <!-- end entry-wrap -->
        </section> <!-- end s-content -->


        <!-- # site-footer
        ================================================== -->
        <footer id="colophon" class="s-footer">

            <div class="row s-footer__bottom">

                <div class="column lg-6 md-6 tab-12">
                    <ul class="s-footer__social">
                        <li>
                            <a href="https://github.com/martina-augustin" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16"> <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/> </svg>
                                <span class="u-screen-reader-text">Github</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.linkedin.com/in/martina-augustin/" target="_blank">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"/></svg>
                                <span class="u-screen-reader-text">Linkedin</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="column lg-6 md-6 tab-12">
                    <div class="ss-copyright">
                        <span>Â© Martina Augustin 2024</span> 
                        <span>Web design by <a href="https://www.styleshout.com/" target="_blank">StyleShout</a></span>
                    </div>
                </div>

            </div> <!-- end s-footer__bottom -->
           
            <div class="ss-go-top">
                <a class="smoothscroll" title="Back to Top" href="#top">
                    <svg width="24" height="24" fill="none" viewBox="0 0 24 24">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.25 10.25L12 4.75L6.75 10.25"/>
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 19.25V5.75"/>
                    </svg>
                </a>
            </div> <!-- end ss-go-top -->

        </footer><!-- end s-footer -->


    <!-- Java Script
    ================================================== -->
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>

</body>
</html>